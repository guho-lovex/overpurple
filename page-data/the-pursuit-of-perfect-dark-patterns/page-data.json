{"componentChunkName":"component---src-components-blog-post-layout-tsx","path":"/the-pursuit-of-perfect-dark-patterns/","result":{"data":{"site":{"siteMetadata":{"title":"overpurple - A blog by GuHo"}},"markdownRemark":{"id":"01102961-8bfa-554e-9e0e-7d2e91c7399b","excerpt":"æˆ‘ä»¬åˆ›å»ºåšå®¢ï¼Œæœ€éš¾çš„ç‚¹åº”è¯¥è«è¿‡äºæ·»åŠ é»‘æš—æ¨¡å¼äº† åœ¨æˆ‘ä»¬æ·»åŠ é»‘æš—æ¨¡å¼å‰ï¼Œæˆ‘ä»¬éœ€è¦å®šä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„äº§å“çš„æ ‡å‡†ã€‚ a. ç”¨æˆ·å•å‡»åˆ‡æ¢äº®æ¨¡å¼å’Œæš—æ¨¡å¼ã€‚ b. è¦ä¿å­˜ç”¨æˆ·çš„è®¾ç½®ï¼Œåœ¨ç”¨æˆ·åˆ·æ–°é¡µé¢åèƒ½è®¿é—®åˆ°æ­£ç¡®çš„ä¸»é¢˜è‰²ã€‚ c. é»˜è®¤æ ¹æ®ç”¨æˆ·çš„æ“ä½œç³»ç»Ÿè®¾ç½®è®¾ç½®ä¸»é¢˜ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™é»˜è®¤çš„æ˜¯äº®æ¨¡å¼ã€‚ dâ€¦","html":"<p>æˆ‘ä»¬åˆ›å»ºåšå®¢ï¼Œæœ€éš¾çš„ç‚¹åº”è¯¥è«è¿‡äºæ·»åŠ é»‘æš—æ¨¡å¼äº†</p>\n<p>åœ¨æˆ‘ä»¬æ·»åŠ é»‘æš—æ¨¡å¼å‰ï¼Œæˆ‘ä»¬éœ€è¦å®šä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„äº§å“çš„æ ‡å‡†ã€‚</p>\n<p>a. ç”¨æˆ·å•å‡»åˆ‡æ¢äº®æ¨¡å¼å’Œæš—æ¨¡å¼ã€‚</p>\n<p>b. è¦ä¿å­˜ç”¨æˆ·çš„è®¾ç½®ï¼Œåœ¨ç”¨æˆ·åˆ·æ–°é¡µé¢åèƒ½è®¿é—®åˆ°æ­£ç¡®çš„ä¸»é¢˜è‰²ã€‚</p>\n<p>c. é»˜è®¤æ ¹æ®ç”¨æˆ·çš„æ“ä½œç³»ç»Ÿè®¾ç½®è®¾ç½®ä¸»é¢˜ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™é»˜è®¤çš„æ˜¯äº®æ¨¡å¼ã€‚</p>\n<p>d. ç½‘ç«™ä¸åº”è¯¥åœ¨é¦–æ¬¡åˆ·æ–°åŠ è½½æ—¶é—ªçƒï¼Œå³å­˜åœ¨ä¸»é¢˜çš„è¿‡æ¸¡æ˜¾ç¤ºï¼Œå³ä½¿ç”¨æˆ·é€‰æ‹©äº†é»˜è®¤çš„é¢œè‰²ä¸»é¢˜ã€‚</p>\n<p>e. ç½‘ç«™æŒ‰é’®ä¸èƒ½æœ‰é”™è¯¯çš„æ˜¾ç¤ºçŠ¶æ€ã€‚</p>\n<p>æˆ‘ä»¬ç»˜åˆ¶ä¸‹æ¥å¦‚å›¾\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/overpurple.io/static/456b88902916365537192419298a44d2/555cf/snipaste_theme.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.050632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAvklEQVR42k2OPW7CUBCEfWAuQMk1IqUhEskB6FJE7ilyA0QSHAknLzxbfn77N4uMg7G0xeqbnZkt3DGflPlUn9TUHcAIbZTwT3yCxdMbNiU2pT2+2vseXU+Hj09muZoNsLsZU8dIvFiusXrG6sUWD9ju4NCc8+zOp6dEkVJ3Cx1IMZcBdL1U39XXsepJM0v4CzHGeA5tkibh96dmYQAiaqaD+ZY0rAYjJiIaRIMIq7IIiVpmhBCaplV4l1Km/gLNOx/QUBdfMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"æ€ç»´å›¾\"\n        title=\"\"\n        src=\"/overpurple.io/static/456b88902916365537192419298a44d2/f058b/snipaste_theme.png\"\n        srcset=\"/overpurple.io/static/456b88902916365537192419298a44d2/c26ae/snipaste_theme.png 158w,\n/overpurple.io/static/456b88902916365537192419298a44d2/6bdcf/snipaste_theme.png 315w,\n/overpurple.io/static/456b88902916365537192419298a44d2/f058b/snipaste_theme.png 630w,\n/overpurple.io/static/456b88902916365537192419298a44d2/40601/snipaste_theme.png 945w,\n/overpurple.io/static/456b88902916365537192419298a44d2/78612/snipaste_theme.png 1260w,\n/overpurple.io/static/456b88902916365537192419298a44d2/555cf/snipaste_theme.png 1960w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h4 id=\"è·å–themeçš„context\" style=\"position:relative;\"><a href=\"#%E8%8E%B7%E5%8F%96theme%E7%9A%84context\" aria-label=\"è·å–themeçš„context permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è·å–themeçš„context</h4>\n<p>é¦–å…ˆæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªè·å–/è®¾ç½®themeçš„state</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>themeMode<span class=\"token punctuation\">,</span> setThemeMode<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">useState</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åœ¨é¡µé¢ç¬¬ä¸€æ¬¡è¿›å…¥æ—¶ï¼Œæˆ‘ä»¬è·å–ä¸‹localStorageä¸‹çš„<code class=\"language-text\">themeMode</code>çš„valueï¼Œå¦‚æœå­˜åœ¨çš„è¯ï¼Œæˆ‘ä»¬å°±è®¾ç½®ç»™themeè¿™ä¸ªstateï¼Œå¦åˆ™æˆ‘ä»¬å°±è·å–ç³»ç»Ÿä¸‹çš„ä¸»é¢˜æ¨¡å¼ã€‚</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> localDarkMode <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'themeMode'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>localDarkMode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setThemeMode</span><span class=\"token punctuation\">(</span>localDarkMode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> isDarkMode <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">matchMedia</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">'(prefers-color-scheme: dark)'</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>matches<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setThemeMode</span><span class=\"token punctuation\">(</span>isDarkMode <span class=\"token operator\">?</span> ThemeModeType<span class=\"token punctuation\">.</span>Dark <span class=\"token operator\">:</span> ThemeModeType<span class=\"token punctuation\">.</span>Light<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç„¶åæˆ‘ä»¬ç»™Provideré‡Œå†æ·»åŠ ä¸€ä¸ªtoggleThemeæ–¹æ³•ï¼Œç”¨äºæ‰‹åŠ¨æ”¹å˜ä¸»é¢˜é¢œè‰²ï¼Œè®¾ç½®å¯¹åº”çš„cssä¸»é¢˜æ ·å¼, isDarkModeä¸ºåˆ‡æ¢æŒ‰é’®å¼€å…³çš„çŠ¶æ€ã€‚</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">toggleTheme</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>isDakMode<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> newTheme <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>isDakMode <span class=\"token operator\">?</span> ThemeModeType<span class=\"token punctuation\">.</span>Light <span class=\"token operator\">:</span> ThemeModeType<span class=\"token punctuation\">.</span>Dark<span class=\"token punctuation\">;</span>\n      <span class=\"token function\">setThemeMode</span><span class=\"token punctuation\">(</span>newTheme<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      window<span class=\"token punctuation\">.</span>localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'themeMode'</span><span class=\"token punctuation\">,</span> newTheme<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> newTheme<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hasWindow<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        window<span class=\"token punctuation\">.</span>__theme <span class=\"token operator\">=</span> newTheme<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„âš ï¸ï¼šåœ¨gatsby ssræ„å»ºé¡µé¢æ—¶ï¼Œwindowæ˜¯æ²¡åŠæ³•è·å–åˆ°çš„ï¼ˆæ°´åŒ–ï¼‰ï¼Œwindowåªèƒ½åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è·å–åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åŠ ä¸ªç±»å‹æ¥åˆ¤æ–­windowæ˜¯å¦å­˜åœ¨ <code class=\"language-text\">typeof window !== 'undefined'</code>ã€‚</p>\n<p>ç„¶åï¼Œæˆ‘ä»¬æŠŠåˆ›å»ºå¥½çš„themeä¸Šä¸‹æ–‡æ·»åŠ è‡³é¡µé¢ç»“æ„ä¸­ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥åŒ…è£¹Layoutç»„ä»¶å°±å¥½ã€‚</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ThemeProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Layout</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ThemeProvider</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™æ ·themeä¸Šä¸‹æ–‡å°±æˆäº†ï¼Œæˆ‘ä»¬åœ¨ç»„ä»¶é‡Œè°ƒç”¨ <code class=\"language-text\">const { toggleTheme } = useContext(ThemeContext);</code>å°±å¯ä»¥åº”ç”¨äº†ã€‚</p>\n<h4 id=\"åˆ‡æ¢ä¸»é¢˜ç»„ä»¶\" style=\"position:relative;\"><a href=\"#%E5%88%87%E6%8D%A2%E4%B8%BB%E9%A2%98%E7%BB%84%E4%BB%B6\" aria-label=\"åˆ‡æ¢ä¸»é¢˜ç»„ä»¶ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>åˆ‡æ¢ä¸»é¢˜ç»„ä»¶</h4>\n<p>åœ¨æˆ‘ä»¬æ·»åŠ å¥½é¡µé¢è·å–å’Œè®¾ç½®themeçš„ä¸Šä¸‹æ–‡åï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåˆ‡æ¢ä¸»é¢˜çš„buttonï¼Œè®©ç”¨æˆ·å¯ä»¥å•å‡»åˆ‡æ¢è®¾ç½®äº®æš—ä¸»é¢˜ã€‚è¿™é‡Œæˆ‘ä»¬å€ŸåŠ©input checkboxç»„ä»¶çš„checkedå±æ€§æ¥è¿›è¡Œé€»è¾‘ä¸Šçš„åˆ¤è¯»ã€‚é¦–å…ˆæˆ‘ä»¬é€šè¿‡reactçš„<code class=\"language-text\">ref</code>æŠŠinput checkboxå˜æˆä¸€ä¸ªå—æ§ç»„ä»¶ï¼Œå°†å…¶ä»–å…ƒç´ çš„äº‹ä»¶ä»£ç†åˆ°inputç»„ä»¶ä¸Šã€‚\næˆ‘ä»¬çš„domç»“æ„å¦‚ä¸‹ï¼š</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toggle-switch<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n    <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>inputRef<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>checkbox<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toggle-switch-checkbox<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">onBlur</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleBlur<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">onFocus</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleFocus<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">aria-label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Switch between Dark and Light mode<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toggle-switch-label<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toggle-switch-dark<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>icon<span class=\"token punctuation\">.</span>dark<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toggle-switch-sun<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>icon<span class=\"token punctuation\">.</span>sun<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">toggle-switch-switch </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>shadowClassName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>æˆ‘ä»¬åœ¨çˆ¶å…ƒç´ ä¸Šæ·»åŠ clickï¼Œç‚¹å‡»clickè·å–å½“ä¸‹ç‚¹å‡»çš„inputçš„checkedçŠ¶æ€ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡çš„æ–¹æ³•toggleThemeï¼Œå¹¶ä¸”åˆ¤æ–­å½“å‰çš„checkedä¸ä¹‹å‰çš„checkedæ˜¯å¦ç›¸ç­‰ï¼Œæ‰§è¡Œinputçš„clickå’Œfocusæ–¹æ³•ã€‚é€šè¿‡focusæ–¹æ³•å¯ä»¥è§¦å‘inputå¾—onFocuså’ŒonBluræ–¹æ³•ï¼Œæ¥ç»™<code class=\"language-text\">toggle-switch-switch</code>åŠ é«˜äº®çš„æ ·å¼ã€‚</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> checkbox <span class=\"token operator\">=</span> inputRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span>\n    onChange<span class=\"token operator\">?.</span><span class=\"token punctuation\">(</span>checkbox<span class=\"token operator\">?.</span>checked<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    preCheckbox<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>checkbox<span class=\"token operator\">?.</span>checked<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>preCheckbox<span class=\"token punctuation\">.</span>current <span class=\"token operator\">===</span> checkbox<span class=\"token operator\">?.</span>checked<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      checkbox<span class=\"token operator\">?.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      checkbox<span class=\"token operator\">?.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4 id=\"ä¿®å¤é¡µé¢åˆ·æ–°å‡ºç°ä¸»é¢˜é—ªçƒè¿‡æ¸¡\" style=\"position:relative;\"><a href=\"#%E4%BF%AE%E5%A4%8D%E9%A1%B5%E9%9D%A2%E5%88%B7%E6%96%B0%E5%87%BA%E7%8E%B0%E4%B8%BB%E9%A2%98%E9%97%AA%E7%83%81%E8%BF%87%E6%B8%A1\" aria-label=\"ä¿®å¤é¡µé¢åˆ·æ–°å‡ºç°ä¸»é¢˜é—ªçƒè¿‡æ¸¡ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ä¿®å¤é¡µé¢åˆ·æ–°å‡ºç°ä¸»é¢˜é—ªçƒè¿‡æ¸¡</h4>\n<p>ç°åœ¨æˆ‘ä»¬é¡µé¢åŸºæœ¬å¯ä»¥è¿›è¡Œäº®æš—ä¸»é¢˜çš„åˆ‡æ¢äº†ã€‚ä½†æ˜¯éšä¹‹è€Œæ¥çš„é—®é¢˜å°±æ˜¯åœ¨gatsbyä¸­ï¼Œï¼Œç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸ä¼šå‘ç”Ÿåœ¨ç”¨æˆ·çš„è®¾å¤‡ä¸­ï¼Œå½“reacté¡µé¢é¦–æ¬¡æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬æ— æ³•çŸ¥é“ç”¨æˆ·çš„é¢œè‰²åå¥½æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥ä¼šé»˜è®¤ä¸ºlight, ç„¶åreactåœ¨å®¢æˆ·ç«¯é‡æ–°rehydrateæ°´åŒ–åå°†å…¶æ›¿æ¢æ‰ï¼Œå¯¼è‡´é¡µé¢ä¼šåˆ·æ–°ä¼šå‡ºç°ç”±äº®è‡³é»‘çš„é—ªçƒã€‚\næˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ç»™ç”¨æˆ·å‘é€htmlçš„æ—¶å€™å°±åº”è¯¥æœ‰æ­£ç¡®çš„é¢œè‰²äº†ã€‚\næ‰€ä»¥åœ¨å½“æˆ‘ä»¬ç¼–è¯‘ç”Ÿæˆé¡µé¢çš„htmlæ—¶ï¼Œåœ¨æˆ‘ä»¬å†…å®¹ä¹‹å‰æ’å…¥ä¸€ä¸ªæå‰è·å–é¢œè‰²çš„scriptè„šæœ¬ã€‚</p>\n<blockquote>\n<p>preformance\nIndexedDB éå¸¸é€‚åˆå­˜å‚¨å¤§å—æ•°æ®ï¼ˆæˆ‘åœ¨Beatmapperä¸­ä½¿ç”¨å®ƒæ¥å­˜å‚¨æ•°å…†å­—èŠ‚çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ï¼‰ã€‚å¯¹äºçŸ­å­—ç¬¦ä¸²ï¼ŒlocalStorage æ˜¯å®Œç¾çš„ğŸ’¯</p>\n</blockquote>\n<h5 id=\"ç¬¬ä¸€ç§-åˆ©ç”¨gatsbyæ„å»ºè¿‡ç¨‹ä¸­çš„æš´éœ²æ–¹æ³•-åœ¨gatsbyä¸­æ›´æ–°html\" style=\"position:relative;\"><a href=\"#%E7%AC%AC%E4%B8%80%E7%A7%8D-%E5%88%A9%E7%94%A8gatsby%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%9A%B4%E9%9C%B2%E6%96%B9%E6%B3%95-%E5%9C%A8gatsby%E4%B8%AD%E6%9B%B4%E6%96%B0html\" aria-label=\"ç¬¬ä¸€ç§ åˆ©ç”¨gatsbyæ„å»ºè¿‡ç¨‹ä¸­çš„æš´éœ²æ–¹æ³• åœ¨gatsbyä¸­æ›´æ–°html permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬ä¸€ç§ï¼š åˆ©ç”¨gatsbyæ„å»ºè¿‡ç¨‹ä¸­çš„æš´éœ²æ–¹æ³• åœ¨gatsbyä¸­æ›´æ–°html</h5>\n<p>å½“gatsbyæ„å»ºæ—¶ä¼šä¸ºæˆ‘ä»¬çš„ç½‘ç«™çš„æ¯ä¸ªé¡µé¢ç”Ÿæˆä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¯¥å†…å®¹ä¹‹ä¸Šæ³¨å…¥ä¸€ä¸ªscriptè„šæœ¬ï¼Œä»¥ä¾¿æµè§ˆå™¨èƒ½å…ˆè§£æå®ƒã€‚\nåœ¨<code class=\"language-text\">gatsby-ssr.tsx</code>ä¸­æ·»åŠ  <code class=\"language-text\">setPreBodyComponents</code>æ–¹æ³•ã€‚è¿™é‡Œçš„onRenderBodyæ–¹æ³•</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">onRenderBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> setPreBodyComponents <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setPreBodyComponents</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MagicScriptTag</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p><code class=\"language-text\">MagicScriptTag</code>å°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„scriptè„šæœ¬ç»„ä»¶ï¼Œåˆ¤æ–­æµè§ˆå™¨å‚¨å­˜çš„ä¸»é¢˜è‰²ï¼Œç»™bodyåŠ ä¸Šäº®æ¨¡å¼æ ·å¼æˆ–æš—æ¨¡å¼æ ·å¼ï¼Œå…·ä½“ä»£ç :<a href=\"https://github.com/guho-lovex/overpurple.io/blob/master/gatsby-ssr.tsx\">gatsby.ssr.tsx</a>\nå¹¶ä¸”æˆ‘ä»¬åœ¨è„šæœ¬ä¸­æ³¨å…¥äº†ä¸€ä¸ªå…¨å±€æ–¹æ³•, åœ¨æµè§ˆå™¨æ§åˆ¶å°ç›´æ¥å¯ä»¥ <code class=\"language-text\">window.__setThemeMode('dark')</code>æ¥åˆ‡æ¢æš—æ¨¡å¼.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">setTheme</span><span class=\"token punctuation\">(</span>newTheme<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span>__theme <span class=\"token operator\">=</span> newTheme\n    preferredTheme <span class=\"token operator\">=</span> newTheme\n    document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> newTheme\n  <span class=\"token punctuation\">}</span>\n  window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">__setThemeMode</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>newTheme<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTheme</span><span class=\"token punctuation\">(</span>newTheme<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      window<span class=\"token punctuation\">.</span>localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'themeMode'</span><span class=\"token punctuation\">,</span> newTheme<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¯·è®°ä½åˆå§‹æ¸²æŸ“å‘ç”Ÿåœ¨ç¼–è¯‘äº‘ä¸­ï¼Œå› æ­¤æœ€å¼€å§‹çš„themeModeä¸€å®šæ˜¯undefinedï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ä¼šè·å¾—ç›¸åŒçš„HTMLï¼Œè¿™ä¸ªhtmlçš„å¤é€‰æ¡†å¼€å§‹å°†å§‹ç»ˆæœªé€‰ä¸­ã€‚æˆ‘ä»¬æœ€å¥½çš„åŠæ³•æ˜¯æ¨è¿Ÿæ¸²æŸ“åˆ‡æ¢ï¼Œåˆ¤æ–­è·å–çš„themeModeä¸å­˜åœ¨æ—¶å°±è¿”å›nullï¼Œç›´åˆ°Reactåº”ç”¨ç¨‹åºçŸ¥é“themeModeæ˜¯ä»€ä¹ˆé¢œè‰²ã€‚\nè¿™é‡Œæˆ‘ä»¬çš„è„šæœ¬é€šè¿‡<code class=\"language-text\">terser</code>åŒ…æ¥è¿›è¡Œå‹ç¼©ã€‚</p>\n<blockquote>\n<p>æ³¨æ„âš ï¸ï¼š terserçš„ç‰ˆæœ¬è¦å°äº5.x,å› ä¸º5.xåŠä»¥ä¸Šçš„ç‰ˆæœ¬çš„è·å–å‹ç¼©åçš„codeæ–¹æ³•ä¸ä¸€æ ·ã€‚è¯¦æƒ…è§ï¼š<a href=\"https://github.com/terser/terser\">https://github.com/terser/terser</a></p>\n</blockquote>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 4.6.11</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> minify <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'terser'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> minifyJsCode <span class=\"token operator\">=</span> <span class=\"token function\">minify</span><span class=\"token punctuation\">(</span>themeScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">;</span></code></pre></div>\n<h5 id=\"ç¬¬äºŒç§è‡ªå®šä¹‰-htmljs\" style=\"position:relative;\"><a href=\"#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E8%87%AA%E5%AE%9A%E4%B9%89-htmljs\" aria-label=\"ç¬¬äºŒç§è‡ªå®šä¹‰ htmljs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬äºŒç§ï¼šè‡ªå®šä¹‰ html.js</h5>\n<p>ä¸ä½¿ç”¨ gatsby-ssr.js ä¸­çš„ api, å¯ä»¥è‡ªå·±åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ html.js æ–‡ä»¶ã€‚<a href=\"https://www.gatsbyjs.com/docs/custom-html/\">Customizing html.js</a>\ngatsbyä½¿ç”¨reactç»„ä»¶æ¥å¤„ç†gatsby coreåº”ç”¨ç¨‹åºå¤–éƒ¨HTMLçš„<code class=\"language-text\">&lt;head></code>å’Œå…¶ä»–éƒ¨åˆ†ã€‚å¤§å¤šæ•°ç«™ç‚¹ä½¿ç”¨gatsbyé™„å¸¦é»˜è®¤çš„ html.jsã€‚</p>\n<p>å¦‚æœéœ€è¦è‡ªå®šä¹‰ç«™ç‚¹çš„html.jsï¼Œè¿è¡Œä¸€ä¸‹å‘½ä»¤å°†é»˜è®¤çš„html.jså¤åˆ¶åˆ°æºä»£ç ä¸­ï¼Œç„¶åæ ¹æ®éœ€è¦è¿›è¡Œä¿®æ”¹ï¼š</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"node\"><pre class=\"language-node\"><code class=\"language-node\">cp .cache/default-html.js src/html.js</code></pre></div>\n<blockquote>\n<p>å½“åœ¨ gatsby-ssr.js ä¸­æ— æ³•ä½¿ç”¨é€‚å½“çš„ API æ—¶ï¼Œè‡ªå®šä¹‰ html.js æ˜¯ä¸€ç§å˜é€šè§£å†³æ–¹æ¡ˆã€‚è€ƒè™‘ä½¿ç”¨ onRenderBody æˆ– onPreRenderHTML ä»£æ›¿ä¸Šè¿°</p>\n</blockquote>\n<p>å¦‚æœæ‚¨çœ‹åˆ°æ­¤é”™è¯¯ï¼šUncaught Error: _registerComponent(...): Target container is not a DOM elementã€‚è¿™æ„å‘³ç€æ‚¨çš„ html.js ç¼ºå°‘æ‰€éœ€çš„â€œç›®æ ‡å®¹å™¨â€ã€‚åœ¨ä½ çš„ <code class=\"language-text\">&lt;body></code> ä¸­ï¼Œä½ å¿…é¡»æœ‰ä¸€ä¸ª id ä¸º <code class=\"language-text\">___gatsby</code> çš„ divï¼Œä¾‹å¦‚ï¼š\nsrc/html.jsä¸­</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span>\n  <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">body</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span></span>\n  <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>___gatsby<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">dangerouslySetInnerHTML</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> __html<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>body <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>è‡ªå®šä¹‰javascript, å°†æˆ‘ä»¬çš„è·å–é¢œè‰²è®¾ç½®é¢œè‰²çš„è„šæœ¬ï¼Œæ”¾è¿›<code class=\"language-text\">__html</code>ä¸­ã€‚</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>script\n  dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n      var name = 'world';\n      console.log('Hello ' + name);\n    </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>","frontmatter":{"title":"The Pursuit of Perfect Dark Patterns","date":"March 24, 2023","description":"The groping for theme switching of gatsby"},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E8%8E%B7%E5%8F%96theme%E7%9A%84context\">è·å–themeçš„context</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%88%87%E6%8D%A2%E4%B8%BB%E9%A2%98%E7%BB%84%E4%BB%B6\">åˆ‡æ¢ä¸»é¢˜ç»„ä»¶</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%BF%AE%E5%A4%8D%E9%A1%B5%E9%9D%A2%E5%88%B7%E6%96%B0%E5%87%BA%E7%8E%B0%E4%B8%BB%E9%A2%98%E9%97%AA%E7%83%81%E8%BF%87%E6%B8%A1\">ä¿®å¤é¡µé¢åˆ·æ–°å‡ºç°ä¸»é¢˜é—ªçƒè¿‡æ¸¡</a></p>\n<ul>\n<li><a href=\"#%E7%AC%AC%E4%B8%80%E7%A7%8D-%E5%88%A9%E7%94%A8gatsby%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%9A%B4%E9%9C%B2%E6%96%B9%E6%B3%95-%E5%9C%A8gatsby%E4%B8%AD%E6%9B%B4%E6%96%B0html\">ç¬¬ä¸€ç§ï¼š åˆ©ç”¨gatsbyæ„å»ºè¿‡ç¨‹ä¸­çš„æš´éœ²æ–¹æ³• åœ¨gatsbyä¸­æ›´æ–°html</a></li>\n<li><a href=\"#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E8%87%AA%E5%AE%9A%E4%B9%89-htmljs\">ç¬¬äºŒç§ï¼šè‡ªå®šä¹‰ html.js</a></li>\n</ul>\n</li>\n</ul>"},"previous":{"fields":{"slug":"/about-building-this-blog/"},"frontmatter":{"title":"About building this blog"}},"next":{"fields":{"slug":"/new-beginnings/"},"frontmatter":{"title":"New Beginnings"}}},"pageContext":{"id":"01102961-8bfa-554e-9e0e-7d2e91c7399b","previousPostId":"7b0c4f45-30b2-56f1-82a9-da7205138fc2","nextPostId":"1fb52d09-8603-5bab-9fd6-a8dfc82d4d3a"}},"staticQueryHashes":["2787180309","3666494887"],"slicesMap":{}}